<html>
<head>
<script type="text/javascript" src="../../bin/libs/silex/js/SilexFramework.js" ></script>
</head>
<body>
<h1>blocks test</h1>
<p>initial work for boot loaders</p>
<p>open this test with http://localhost, not file://</p>
<p>test</p>
<div id="stage" style="height:300; width:100%"></div>
<br />
<br />
<br />
<br />
<br />
<br />
<h1>haXe traces</h1>
<div id="haxe:trace" style="width:100%"></div>
<script type="text/javascript">
	function onBlockOpenSuccess()
	{
		console.log("onBlockOpenSuccess "+block._children[0].getSkinUrl()+" - "+block._children[0].getDOMObject()+ " - auto open "+block._children[0].getBlockData().isAutoOpen);
		block._children[0].open(onBlockOpenSuccess2, onBlockOpenError);
	}
	function onBlockOpenSuccess2()
	{
		console.log("onBlockOpenSuccess2 "+block._children[0].getSkinUrl()+" - "+block._children[0].getDOMObject());
	}
	function onBlockOpenError(str)
	{
		console.error("onBlockOpenError - "+str);
	}

	function onLoadBlockDataSuccess(blockBuilder)
	{
		console.log("onLoadBlockDataSuccess");
		console.log("test "+block.getBlockData().className + " * "+block.getDOMObject()+" - "+block.getDOMObject().getHeight()+" - "+block.getSkinUrl());
		block.open(onBlockOpenSuccess, onBlockOpenError);
	}
	function onLoadBlockDataError(str)
	{
		console.error("onLoadBlockDataError - "+str);
	}

	org.silex.blocks.HGroup = Object;
	
	console.log("Test the creation of a block tree from a a XML file(s)");
	console.log("_____________________________________________________________________");
	
	console.log("--");
	console.log("create and customize settings/config");
	console.log("--");

	// create and customize settings/config
	var configData = org.silex.core.config.Config.getConfigData();
	configData.runtime = org.silex.core.config.RuntimeValue.js;
	org.silex.core.config.Config.setConfigData(configData);
	
	console.log("--");
	console.log("create the root DOMObject and attach it to the js dom");
	console.log("--");
	// create the root DOMObject and attach it to the js dom
	var domObject = new org.silex.runtime.domobject.js.ContainerDOMObject(document.getElementById("stage"));

	console.log("--");
	console.log("create the root Block, which data are in test.xml, and attach it to the DOMObject");
	console.log("--");
	// create the root Block, which data are in test.xml
	var block = new org.silex.core.block.Block("test.xml");
	block.setDOMObject(domObject);

	console.log("--");
	console.log("start loading the first block");
	console.log("--");
	// start loading the first block
	var blockBuilder = new org.silex.core.block.BlockBuilder(block);
	blockBuilder.loadBlockData(onLoadBlockDataSuccess, onLoadBlockDataError);
	
	console.log("--");
	console.log("end of the test");
	console.log("--");
</script>
<p>/test</p>
</body>
</html>